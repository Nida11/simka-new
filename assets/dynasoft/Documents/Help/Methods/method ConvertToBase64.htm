
<html>
<head>
    <title>Method ConvertToBase64 - Dynamic Web TWAIN 12</title>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
    <link href="../Styles/docs.css" type="text/css" rel="stylesheet" />
    <script src="../Scripts/common.js" type="text/javascript"></script>
</head>
<body id="docs-page">
    <div class='apiIndex'>
        <a href='../index.htm'>Index</a>&nbsp;&gt;&nbsp;
        <a href='method%20ConvertToBase64.htm'>ConvertToBase64</a>
    </div>
    <div class='content' id='content'>
        <h1>ConvertToBase64()</h1>
        <h3>Description</h3>
        <p>Converts the images of specified indices in buffer to a base64 string.</p>

        <h3>Syntax</h3>
        <div class='spec'>
            <p>
                .ConvertToBase64(indices, enumImageType, asyncSuccessFunc, asyncFailureFunc);
            </p>
        </div>
        <h3>Parameters</h3>
        <p>
            <code class="type">&lt;int[]&gt;</code> <code>indices</code>: specifies the indices of images in buffer. The index is 0-based. <br />
            <code class="type">EnumDWT_ImageType</code> <code>enumImageType</code>: specifies the format. <br />
			        <p>
            <table>
                <tr>
                    <th>Type</th>
                    <th>Numeric Value</th>
                </tr>
                <tr>
                    <td>IT_BMP</td>
                    <td>0</td>
                </tr>
                <tr>
                    <td>IT_JPG</td>
                    <td>1</td>
                </tr>
                <tr>
                    <td>IT_TIF</td>
                    <td>2</td>
                </tr>
                <tr>
                    <td>IT_PNG</td>
                    <td>3</td>
                </tr>
                <tr>
                    <td>IT_PDF</td>
                    <td>4</td>
                </tr>
            </table>
        </p>
			<code class="type">&lt;OnSuccess function&gt;</code> <code>asyncSuccessFunc</code>: callback function triggered when the file is converted successfully.  <br />
			<code class="type">&lt;OnFailure function&gt;</code> <code>asyncFailureFunc</code>: callback function triggered when the file fails to be converted. <br />
        </p>
        <p class="specialnotice">
            Please refer to the function prototype <a href="../Programmer%20Guide/Function%20Prototypes.htm#OnSuccess"><code class="type">OnSuccess</code></a> or <a href="../Programmer%20Guide/Function%20Prototypes.htm#OnFailure"><code class="type">OnFailure</code></a>.
        </p>
        <h3>Return value</h3>
        <p>
			<p>
            <code class="type">&lt;Base64Result&gt;</code> is returned in the callback <code>asyncSuccessFunc()</code>.
			</p>
			<p>
            Methods available in <code class="type">&lt;Base64Result&gt;</code> object
            <table>
				<tr>
                    <th style="width:70px">Data Type</th>
                    <th>Method Name</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td><code class="type">&lt;int&gt;</code></td>
                    <td>getLength()</td>
                    <td>Returns the length of the Base64 String</td>
                </tr>
                <tr>
                    <td><code class="type">&lt;string&gt;</code></td>
                    <td>getData(offset, length)</td>
                    <td>Returns the string containing the extracted part of the Base64 string. The parameter <code>offset</code> means the position where to start the extraction. The parameter <code>length</code> means the number of characters to extract. </td>
                </tr>
                <tr>
                    <td><code class="type">&lt;string&gt;</code></td>
                    <td>getMD5()</td>
                    <td>Returns the MD5 of the Base64 String. </td>
                </tr>
			</table>
			</p>
            The result string returned from <code>getData</code> is the pure base64 string with no extra info. For example, <br />
            <code>"/9j/4AAQSkZJRgABA..."</code>.<br />
            To use the string in most circumstances, you need to add extra info like<br />
            <code><span class="red">data:image/png;base64,</span>"/9j/4AAQSkZJRgABA..."</code>.<br />
        </p>
        <p>Because this method is async only, the returned value doesn't mean if the convert succeeds or not. When conversion fails, check <code><a href="../Properties/prop%20ErrorCode.htm">ErrorCode</a></code> or <code><a href="../Properties/prop%20ErrorString.htm">ErrorString</a></code> for error information.</p>
		<h3>Remarks</h3>
        <p class="notice">This method is valid only in HTML5 Edtion</p>
		<h3>Example</h3>
        <code class="language-javascript">
            <pre>
DWObject.ConvertToBase64 ([1,3], EnumDWT_ImageType.IT_PDF, asyncSuccessFunc, asyncFailureFunc);
function asyncSuccessFunc (result) {
     var length=result.getLength();
     console.log(result.getData(0,length));
     console.log(result);
}
function asyncFailureFunc (errorCode, errorString) {
     alert("ErrorCode: "+errorCode +"\r"+"ErrorString:"+ errorString);
}
</pre>
        </code>
    </div>
</body>
</html>